<index.html>
<html lang="en">
<head>
    <!-- ... (head content remains unchanged) ... -->
</head>
<body>

    <!-- ... (body content remains unchanged) ... -->

<script>
// Main App Object: Contains all logic and data for the website.
const App = {
    elements: {},
    propertiesData: [],
    supabase: null,
    
    init() {
        document.addEventListener('DOMContentLoaded', () => {
            this.cacheDOMElements();
            this.injectHTML();
            this.cacheInjectedElements();
            this.bindEvents();
            this.connectToSupabase();
            const initialPage = window.location.hash.substring(1) || 'hero-section';
            this.showPage(initialPage, true);
        });
    },

    connectToSupabase() {
        // FIX: Use bracket notation for element access
        this.elements['loading-text'].textContent = "Connecting to Supabase...";
        const SUPABASE_URL = 'https://ikukwjgqnegtvzwelldnw.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlrdWt3amdxbmVndHZ6d2VuZG53Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk5NTAxMTIsImV4cCI6MjA2NTUyNjExMn0.z4NAbPaIaUYkPugyOZSyMJGN308LP-6qw2bylibHS84';

        if (!window.supabase) {
            console.error("Supabase client library not loaded.");
            this.elements['loading-text'].textContent = "Error: Supabase library missing.";
            return;
        }

        try {
            this.supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            this.loadProperties();
        } catch(error) {
            console.error("Supabase connection failed:", error);
            this.showNotification("Could not connect to database", "error");
            this.hideLoading();
        }
    },

    async loadProperties() {
        if (!this.supabase) return;
        // FIX: Use consistent bracket notation
        this.elements['loading-text'].textContent = "Loading properties...";
        
        const { data, error } = await this.supabase
            .from('properties')
            .select('*')
            .order('created_at', { ascending: false });

        if (error) {
            console.error('Error loading properties:', error);
            this.showNotification(`Error: ${error.message}`, 'error');
            this.elements['loading-text'].textContent = 'Failed to load data. Check table name & RLS.';
        } else {
            this.propertiesData = data || [];
            this.filterAndRenderProperties();
            this.hideLoading();
        }
    },

    // ... (rest of the methods remain unchanged) ...

    hideLoading() {
        // FIX: Use bracket notation for element access
        const overlay = this.elements['loading-overlay'];
        if (overlay && overlay.style.display !== 'none') {
            overlay.style.opacity = '0';
            overlay.addEventListener('transitionend', () => {
                overlay.style.display = 'none';
            }, { once: true });
        }
    },

    // ... (rest of the methods remain unchanged) ...
};

App.init();
</script>

</body>
</html>
